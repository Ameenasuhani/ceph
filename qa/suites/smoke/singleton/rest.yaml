overrides:
  ceph_ansible:
    vars:
      ceph_conf_overrides:
        global:
          osd default pool size: 3
          osd pool default pg num: 64
          osd pool default pgp num: 64
          mon max pg per osd: 1024
      ceph_mgr_modules:
         - status
         - restful
      dmcrypt_journal_collocation: true
      ceph_stable_release: luminous
      ceph_origin: distro
      ceph_stable: true
      ceph_stable_rh_storage: true
      ceph_test: true
      journal_size: 1024
      osd_auto_discovery: false
      osd_scenario: collocated
roles:
- - mon.a
- - mon.b
  - mgr.x
- - mds.a
- - osd.0
  - osd.1
  - osd.2
  - mgr.y
- - osd.3
  - osd.4
  - osd.5
- - osd.6
  - osd.7
  - osd.8
  - client.0
tasks:
- ssh-keys:
- ceph-ansible:
- install.ship_utilities:
- exec:
    mgr.x:
      - systemctl stop ceph-mgr.target
      - sleep 5
      - ceph -s
- exec:
    mon.a:
      - ceph restful create-key admin
      - ceph restful create-self-signed-cert
      - ceph restful restart
- workunit:
    clients:
      client.0:
        - rest/test-restful.sh
